<VirtualHost *:80>
	ServerName  dev.fastenaltest.com
	ServerAlias dev.fastenaltest.com

	RewriteEngine On
	RewriteCond %{HTTPS} !=on
	RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R,L]

	ErrorLog ${APACHE_LOG_DIR}/dev-fastenal-authoring-error.log
	CustomLog ${APACHE_LOG_DIR}/dev-fastenal-authoring-access.log combined
</VirtualHost>

<VirtualHost *:443>
	ServerName  dev.fastenaltest.com
	ServerAlias dev.fastenaltest.com

	DocumentRoot /var/www/crafter/

	<LocationMatch "^/solr/">
		AuthType Basic
		AuthName "Restricted Access"
		AuthBasicProvider file
		AuthUserFile auth/crafter
		Require valid-user
	</LocationMatch>

	ErrorDocument 503 /503.html
	ErrorDocument 404 /404.html


	SSLEngine On
	Include commons/security.conf
	SSLCertificateFile sslcerts/fastenal/fastenal.crt
	SSLCertificateKeyFile sslcerts/fastenal/fastenal.key

	#RewriteEngine On
	#RewriteRule ^/$ /studio [R,L]

	ProxyPreserveHost On

	ProxyPass /503.html !

	# Solr
	ProxyPass /solr http://localhost:8694/solr
	ProxyPassReverse /solr http://localhost:8694/solr

	# Studio
	ProxyPass / ajp://localhost:8009/
	ProxyPassReverse / ajp://localhost:8009/

	ErrorLog ${APACHE_LOG_DIR}/dev-fastenal-authoring-error.log
	CustomLog ${APACHE_LOG_DIR}/dev-fastenal-authoring-access.log combined
</VirtualHost>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
